(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     86536,       2800]
NotebookOptionsPosition[     81586,       2630]
NotebookOutlinePosition[     81930,       2645]
CellTagsIndexPosition[     81887,       2642]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"f", ":=", 
  RowBox[{"ProductLog", "[", "Yi", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yi", ":=", 
   RowBox[{"bt", "*", "Rs", "*", 
    RowBox[{"Is", "/", "n"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"bt", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rs", "*", "Is"}], "+", "Vi"}], ")"}], "/", "n"}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f1", ":=", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", "n"}], "]"}]}], "\[IndentingNewLine]", "f1"}], "Input",
 CellChangeTimes->{{3.526112943296875*^9, 3.526112975515625*^9}, {
   3.526113013421875*^9, 3.526113024203125*^9}, {3.52611313303125*^9, 
   3.52611314471875*^9}, {3.526113223578125*^9, 3.526113256953125*^9}, {
   3.52611334040625*^9, 3.5261133936875*^9}, {3.52611349140625*^9, 
   3.526113584234375*^9}, {3.52611424440625*^9, 3.526114294875*^9}, {
   3.526114424625*^9, 3.5261144554375*^9}, {3.52611453259375*^9, 
   3.526114569421875*^9}, {3.52611463775*^9, 3.52611465778125*^9}, {
   3.52611468878125*^9, 3.526114690046875*^9}, {3.526115355921875*^9, 
   3.526115361953125*^9}, {3.526115689296875*^9, 3.526115689765625*^9}, {
   3.526115734546875*^9, 3.5261157380625*^9}, {3.526115822765625*^9, 
   3.52611582665625*^9}, 3.52611592003125*^9, {3.5261167988125*^9, 
   3.526116799484375*^9}, {3.526116909578125*^9, 3.526116933765625*^9}, {
   3.526117000375*^9, 3.52611700278125*^9}, {3.526117034109375*^9, 
   3.52611703678125*^9}, {3.526117091*^9, 3.526117104171875*^9}, {
   3.526117152921875*^9, 3.52611717671875*^9}, {3.52611730903125*^9, 
   3.526117405765625*^9}, {3.526117442390625*^9, 3.5261174568125*^9}, {
   3.526117500734375*^9, 3.526117517765625*^9}, {3.526179331046875*^9, 
   3.526179344625*^9}, {3.5261794281875*^9, 3.526179525671875*^9}, {
   3.526179569171875*^9, 3.52617959840625*^9}, {3.5261797514375*^9, 
   3.526179790078125*^9}, {3.5261798569375*^9, 3.5261799205625*^9}, 
   3.52618029696875*^9, {3.52618131403125*^9, 3.52618131859375*^9}, 
   3.52618400409375*^9, 3.526184067421875*^9, {3.526184233484375*^9, 
   3.5261843273125*^9}, {3.526184659*^9, 3.526184673828125*^9}, {
   3.52618527290625*^9, 3.526185274109375*^9}, {3.5262669545*^9, 
   3.52626696165625*^9}, {3.52626717275*^9, 3.526267201359375*^9}, 
   3.526267325484375*^9, {3.52669818190625*^9, 3.5266982334375*^9}, {
   3.530878299953125*^9, 3.530878349828125*^9}, {3.530878501890625*^9, 
   3.53087850440625*^9}, {3.53102649865625*^9, 3.531026550640625*^9}, 
   3.531026587796875*^9, {3.5310266640625*^9, 3.53102670703125*^9}, {
   3.53121441478125*^9, 3.53121442221875*^9}, {3.531214543890625*^9, 
   3.53121461796875*^9}, {3.531214671234375*^9, 3.53121467171875*^9}, {
   3.60049813203125*^9, 3.60049814690625*^9}, {3.600498209015625*^9, 
   3.600498220375*^9}, {3.6004982521875*^9, 3.6004984259375*^9}, {
   3.6004986378125*^9, 3.600498640765625*^9}, {3.60049867240625*^9, 
   3.6004987201875*^9}, {3.600498761390625*^9, 3.60049876571875*^9}, {
   3.600498838625*^9, 3.600498855375*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]}]], " ", "n", 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], 
       SuperscriptBox["n", "2"]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["bt", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], 
      SuperscriptBox["n", "3"]]}], ")"}], " ", 
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}]}], 
  RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.60058276215625*^9, 3.60058276590625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]}]], " ", "n", 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], 
       SuperscriptBox["n", "2"]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["bt", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], 
      SuperscriptBox["n", "3"]]}], ")"}], " ", 
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}]}], 
  RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]], "\[IndentingNewLine]", 
 RowBox[{"Zi", ":=", 
  RowBox[{
   RowBox[{"f", "*", 
    RowBox[{
     RowBox[{"n", "/", "bt"}], "/", "Rs"}]}], "+", 
   RowBox[{"Vi", "/", "Rsh"}], "-", "Is", "-", 
   "Ii"}]}], "\[IndentingNewLine]", 
 RowBox[{"S", ":=", 
  RowBox[{
   RowBox[{"Zi", "^", "2"}], "/", "Ii"}]}], "\[IndentingNewLine]", 
 RowBox[{"ff2", ":=", 
  RowBox[{"D", "[", 
   RowBox[{"Zi", ",", "Rs"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "ff2", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6004991101875*^9, 3.600499112125*^9}, {
  3.60049918521875*^9, 3.60049924715625*^9}, {3.60049929434375*^9, 
  3.600499297109375*^9}, {3.60049957759375*^9, 3.60049958178125*^9}, {
  3.600499906859375*^9, 3.6004999073125*^9}, {3.600499943109375*^9, 
  3.6004999435*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]}]], " ", "n", 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], 
       SuperscriptBox["n", "2"]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["bt", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], 
      SuperscriptBox["n", "3"]]}], ")"}], " ", 
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}]}], 
  RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600499312171875*^9, 3.6004995836875*^9, 
  3.600500157421875*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", "Is", " ", "Rs"}], "-", 
     RowBox[{"n", " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}]}], ")"}]}], 
  RowBox[{"bt", " ", 
   SuperscriptBox["Rs", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600499312171875*^9, 3.6004995836875*^9, 
  3.600500157453125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ff1", ":=", 
  RowBox[{"D", "[", 
   RowBox[{"Zi", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "ff1", "]"}]}], "Input",
 CellChangeTimes->{{3.600499898046875*^9, 3.600499939421875*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "bt"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "+", 
     RowBox[{"n", " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}]}], ")"}]}], 
  RowBox[{"bt", " ", "n", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.6004999459375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ff3", ":=", 
  RowBox[{"D", "[", 
   RowBox[{"Zi", ",", "Is"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "ff3", "]"}]}], "Input",
 CellChangeTimes->{{3.6005002523125*^9, 3.60050028003125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "bt"}], " ", "Is", " ", "Rs"}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}]}], 
  RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600500281890625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ff4", ":=", 
  RowBox[{"D", "[", 
   RowBox[{"Zi", ",", "Rsh"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "ff4", "]"}]}], "Input",
 CellChangeTimes->{{3.600500370796875*^9, 3.60050039209375*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["Vi", 
   SuperscriptBox["Rsh", "2"]]}]], "Output",
 CellChangeTimes->{3.600500393046875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g1", ":=", 
  RowBox[{"ff1", "*", "Zi"}]}], "\[IndentingNewLine]", 
 RowBox[{"g11", ":=", 
  RowBox[{"D", "[", 
   RowBox[{"g1", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "g11", "]"}]}], "Input",
 CellChangeTimes->{{3.6005023433125*^9, 3.600502406359375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "bt"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "+", 
      RowBox[{"n", " ", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"bt", " ", "Rs", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ii", " ", "Rsh"}], "+", 
         RowBox[{"Is", " ", "Rsh"}], "-", "Vi"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "n"}], "+", 
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "n", " ", "Rsh"}], "+", 
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Ii"}], " ", "Rs", " ", "Rsh"}], "+", 
            RowBox[{"Is", " ", "Rs", " ", "Rsh"}], "+", 
            RowBox[{"Rs", " ", "Vi"}], "+", 
            RowBox[{"2", " ", "Rsh", " ", "Vi"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], "-", 
      RowBox[{"bt", " ", "n", " ", "Rsh", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"ProductLog", "[", 
         FractionBox[
          RowBox[{"bt", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"bt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
           "Is", " ", "Rs"}], "n"], "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["n", "2"], " ", "Rsh", " ", 
       SuperscriptBox[
        RowBox[{"ProductLog", "[", 
         FractionBox[
          RowBox[{"bt", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"bt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
           "Is", " ", "Rs"}], "n"], "]"}], "3"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["bt", "2"], " ", 
    SuperscriptBox["n", "3"], " ", 
    SuperscriptBox["Rs", "2"], " ", "Rsh", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.600502409359375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", "%", "]"}], "\[IndentingNewLine]", 
 RowBox[{"r1", ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", "*", "f"}], "-", 
     RowBox[{"bt", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Is", "*", "Rs"}], "+", "Vi"}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"bt", "*", "n", "*", "Rs", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "f"}], ")"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", "r1"}], "Input",
 CellChangeTimes->{{3.600498555234375*^9, 3.60049856234375*^9}, 
   3.6004991195*^9, {3.60050354909375*^9, 3.600503555640625*^9}, {
   3.600503593015625*^9, 3.60050359815625*^9}, {3.600503649046875*^9, 
   3.600503729734375*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "bt"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}]}], 
  RowBox[{"bt", " ", "n", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600503732109375*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "bt"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}]}], 
  RowBox[{"bt", " ", "n", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600503732125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{"r1", ",", "n"}], "]"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.600498893078125*^9, 3.600498960046875*^9}, {
  3.60049900165625*^9, 3.600499105*^9}, {3.60050374434375*^9, 
  3.60050379465625*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"bt", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "+", 
      RowBox[{
       SuperscriptBox["bt", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}], "2"]}]}], ")"}], " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}], "+", 
   RowBox[{"bt", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], 
  RowBox[{"bt", " ", 
   SuperscriptBox["n", "3"], " ", "Rs", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{{3.600503770375*^9, 3.600503796421875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r1", ",", "Rs"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600504002234375*^9, 3.600504011640625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"bt", " ", "n", " ", "Vi"}], "+", 
    RowBox[{"bt", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"bt", " ", 
        SuperscriptBox["Is", "2"], " ", 
        SuperscriptBox["Rs", "2"]}], "+", 
       RowBox[{"3", " ", "n", " ", "Vi"}], "+", 
       RowBox[{"Is", " ", "Rs", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "n"}], "+", 
          RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], "+", 
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "n"}], "+", 
       RowBox[{"bt", " ", "Vi"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox["n", "2"], " ", 
     SuperscriptBox[
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}], "3"]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"bt", " ", 
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["Rs", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.60050401328125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r1", ",", "Is"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6005041808125*^9, 3.60050418253125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "bt"}], " ", "Is", " ", "n", " ", "Rs"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "+", 
      RowBox[{"bt", " ", "n", " ", "Vi"}], "+", 
      RowBox[{
       SuperscriptBox["bt", "2"], " ", "Is", " ", "Rs", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}], "-", 
   RowBox[{"bt", " ", "Is", " ", "n", " ", "Rs", " ", 
    SuperscriptBox[
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], 
  RowBox[{"bt", " ", "Is", " ", 
   SuperscriptBox["n", "2"], " ", "Rs", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{3.600504184046875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r1", ",", "Rsh"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6005043338125*^9, 3.60050433575*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.600504337328125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", "n"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60050444278125*^9, 3.600504447234375*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "+", 
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}], 
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.600504448609375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", "n"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "+", 
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}], 
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.60050452515625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", "Rs"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60050453021875*^9, 3.60050453996875*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}], " ", 
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}]}], 
  RowBox[{"n", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.600504535390625*^9, 3.600504541421875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", "Is"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600504594140625*^9, 3.600504594671875*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}], " ", 
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}]}], 
  RowBox[{"Is", " ", "n", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600504608140625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", "Rsh"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60050466859375*^9, 3.600504670390625*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.600504671296875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"r1", ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", "*", "f"}], "-", 
     RowBox[{"bt", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Is", "*", "Rs"}], "+", "Vi"}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"bt", "*", "n", "*", "Rs", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "f"}], ")"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", "r1"}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "bt"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}]}], 
  RowBox[{"bt", " ", "n", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600508707640625*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"r2", ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", "*", "Is", "*", "Rs"}], "-", 
     RowBox[{"n", "*", "f"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"bt", "*", "Rs", "*", "Rs", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "f"}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.600508520609375*^9, 3.600508522859375*^9}, {
  3.6005086205*^9, 3.600508664953125*^9}}],

Cell[CellGroupData[{

Cell[BoxData["r2"], "Input",
 CellChangeTimes->{{3.600508676171875*^9, 3.600508676578125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"bt", " ", "Is", " ", "Rs"}], "-", 
   RowBox[{"n", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}]}], 
  RowBox[{"bt", " ", 
   SuperscriptBox["Rs", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.60050867728125*^9, {3.6005087231875*^9, 3.600508737375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r2", ",", "n"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60050879590625*^9, 3.600508796953125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"bt", " ", 
          SuperscriptBox["Is", "2"], " ", 
          SuperscriptBox["Rs", "2"]}], "+", 
         RowBox[{"n", " ", "Vi"}], "+", 
         RowBox[{"Is", " ", "Rs", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["n", "2"], " ", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["n", "2"], " ", 
       SuperscriptBox[
        RowBox[{"ProductLog", "[", 
         FractionBox[
          RowBox[{"bt", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"bt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
           "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"bt", " ", 
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["Rs", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.600508798375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r2", ",", "Rs"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6005090385625*^9, 3.6005090395*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "bt"}], " ", "Is", " ", "n", " ", "Rs"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "2"], "-", 
       RowBox[{"4", " ", "bt", " ", "Is", " ", "n", " ", "Rs"}], "-", 
       RowBox[{
        SuperscriptBox["bt", "2"], " ", 
        SuperscriptBox["Is", "2"], " ", 
        SuperscriptBox["Rs", "2"]}]}], ")"}], " ", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], "+", 
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "n"}], "-", 
       RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["n", "2"], " ", 
     SuperscriptBox[
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}], "3"]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"bt", " ", "n", " ", 
    SuperscriptBox["Rs", "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.600509040703125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r2", ",", "Is"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600509211421875*^9, 3.60050921234375*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"bt", " ", "Is", " ", "n", " ", "Rs"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "+", 
      RowBox[{
       SuperscriptBox["bt", "2"], " ", 
       SuperscriptBox["Is", "2"], " ", 
       SuperscriptBox["Rs", "2"]}]}], ")"}], " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}], "+", 
   RowBox[{"bt", " ", "Is", " ", "n", " ", "Rs", " ", 
    SuperscriptBox[
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], 
  RowBox[{"bt", " ", "Is", " ", "n", " ", 
   SuperscriptBox["Rs", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{3.6005092139375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r2", ",", "Rsh"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60050930425*^9, 3.60050930690625*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.60050930815625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ff3", ",", "n"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600510351703125*^9, 3.600510353640625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "bt"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"bt", " ", 
          SuperscriptBox["Is", "2"], " ", 
          SuperscriptBox["Rs", "2"]}], "+", 
         RowBox[{"n", " ", "Vi"}], "+", 
         RowBox[{"Is", " ", "Rs", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["n", "2"], " ", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["n", "2"], " ", 
       SuperscriptBox[
        RowBox[{"ProductLog", "[", 
         FractionBox[
          RowBox[{"bt", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"bt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
           "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"bt", " ", "Is", " ", 
    SuperscriptBox["n", "2"], " ", "Rs", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.60051035734375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{"ff3", ",", "Rs"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.60051051425*^9, 3.60051051684375*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "n"}], "+", 
        RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox[
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], 
  RowBox[{"bt", " ", "Is", " ", "n", " ", 
   SuperscriptBox["Rs", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{3.6005105196875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ff3", ",", "Is"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600510649984375*^9, 3.600510651390625*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "n"}], "+", 
        RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox[
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], 
  RowBox[{"bt", " ", 
   SuperscriptBox["Is", "2"], " ", "n", " ", "Rs", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{3.60051065284375*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"r3", ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", "*", "f"}], "-", 
     RowBox[{"bt", "*", "Is", "*", "Rs"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"bt", "*", "Is", "*", "Rs", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "f"}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.600510782296875*^9, 3.60051083071875*^9}}],

Cell[CellGroupData[{

Cell[BoxData["r3"], "Input",
 CellChangeTimes->{{3.600510836109375*^9, 3.600510836515625*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "bt"}], " ", "Is", " ", "Rs"}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}]}]}], 
  RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", "Rs"}], "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.600510837453125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r3", ",", "n"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6005108549375*^9, 3.6005108559375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is",
        " ", "Rs"}], "n"], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "bt"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"bt", " ", 
          SuperscriptBox["Is", "2"], " ", 
          SuperscriptBox["Rs", "2"]}], "+", 
         RowBox[{"n", " ", "Vi"}], "+", 
         RowBox[{"Is", " ", "Rs", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "n"}], "+", 
            RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["n", "2"], " ", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["n", "2"], " ", 
       SuperscriptBox[
        RowBox[{"ProductLog", "[", 
         FractionBox[
          RowBox[{"bt", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"bt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
           "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"bt", " ", "Is", " ", 
    SuperscriptBox["n", "2"], " ", "Rs", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.60051085759375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r3", ",", "Rs"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60051088971875*^9, 3.6005108908125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "n"}], "+", 
        RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox[
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], 
  RowBox[{"bt", " ", "Is", " ", "n", " ", 
   SuperscriptBox["Rs", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{3.60051090121875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r3", ",", "Is"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6005108960625*^9, 3.60051089740625*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", "Rs"}], "n"], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", "Is", " ", "Rs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "n"}], "+", 
        RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox[
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
          "Is", " ", "Rs"}], "n"], "]"}], "2"]}]}], ")"}]}], 
  RowBox[{"bt", " ", 
   SuperscriptBox["Is", "2"], " ", "n", " ", "Rs", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", "Rs"}], "n"], "]"}]}], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{3.60051090396875*^9, 3.60058273953125*^9, 
  3.6005827779375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"r3", ",", "Rsh"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600510922046875*^9, 3.600510923828125*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.600510925078125*^9, 3.600582732421875*^9, 
  3.600582789796875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ff4", ",", "Rsh"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600511910671875*^9, 3.60051191284375*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "Vi"}], 
  SuperscriptBox["Rsh", "3"]]], "Output",
 CellChangeTimes->{3.600511914609375*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"YYi", ":=", 
    RowBox[{"bt", "*", 
     RowBox[{"(", 
      RowBox[{"Rs", "-", 
       RowBox[{"al", "*", "fr"}]}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Is", "-", 
        RowBox[{"al", "*", "fs"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"al", "*", "fn"}]}], ")"}]}], "*", 
     RowBox[{"E", "^", 
      RowBox[{"(", 
       RowBox[{"bt", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Rs", "-", 
              RowBox[{"al", "*", "fr"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"Is", "-", 
              RowBox[{"al", "*", "fs"}]}], ")"}]}], "+", "Vi"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"al", "*", "fn"}]}], ")"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.600582821921875*^9, 3.6005829051875*^9}}],

Cell[BoxData[
 RowBox[{"ZZi", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductLog", "[", "YYi", "]"}], "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"al", "*", "fn"}]}], ")"}], "/", "bt"}], "/", 
     RowBox[{"(", 
      RowBox[{"Rs", "-", 
       RowBox[{"al", "*", "fr"}]}], ")"}]}]}], "+", 
   RowBox[{"Vi", "/", 
    RowBox[{"(", 
     RowBox[{"Rsh", "-", 
      RowBox[{"al", "*", "fh"}]}], ")"}]}], "-", 
   RowBox[{"(", 
    RowBox[{"Is", "-", 
     RowBox[{"al", "*", "fs"}]}], ")"}], "-", "Ii"}]}]], "Input",
 CellChangeTimes->{{3.600582914703125*^9, 3.6005829888125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ZZi", ",", "al"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60058299525*^9, 3.60058300984375*^9}}],

Cell[BoxData[
 RowBox[{"fs", "+", 
  FractionBox[
   RowBox[{"fh", " ", "Vi"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "al"}], " ", "fh"}], "+", "Rsh"}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{"fn", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], "+", 
            "Vi"}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}]}], 
   RowBox[{"bt", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"al", " ", "fr"}], "-", "Rs"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"fr", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}], ")"}], " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], "+", 
            "Vi"}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}]}], 
   RowBox[{"bt", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}], "2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["al", "4"], " ", "bt", " ", "fn", " ", 
        SuperscriptBox["fr", "2"], " ", 
        SuperscriptBox["fs", "2"]}], "+", 
       RowBox[{"fr", " ", "Is", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"n", "+", 
          RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["al", "3"], " ", "fr", " ", "fs", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["fn", "2"], "+", 
          RowBox[{"2", " ", "bt", " ", "fr", " ", "fs", " ", "n"}], "+", 
          RowBox[{"bt", " ", "fn", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fr", " ", "Is"}], "+", 
             RowBox[{"fs", " ", "Rs"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["al", "2"], " ", "fr", " ", "fs", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "bt", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fr", " ", "Is"}], "+", 
             RowBox[{"fs", " ", "Rs"}]}], ")"}]}], "+", 
          RowBox[{"fn", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "n"}], "-", 
             RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"al", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["fn", "2"], " ", "Is", " ", "Rs"}], "-", 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bt", " ", 
              SuperscriptBox["fr", "2"], " ", 
              SuperscriptBox["Is", "2"]}], "+", 
             RowBox[{"2", " ", "fr", " ", "fs", " ", "n"}], "+", 
             RowBox[{
             "4", " ", "bt", " ", "fr", " ", "fs", " ", "Is", " ", "Rs"}], 
             "+", 
             RowBox[{"bt", " ", 
              SuperscriptBox["fs", "2"], " ", 
              SuperscriptBox["Rs", "2"]}]}], ")"}]}], "+", 
          RowBox[{"fn", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fr", " ", "Is"}], "+", 
             RowBox[{"fs", " ", "Rs"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "n"}], "+", 
             RowBox[{"bt", " ", "Is", " ", "Rs"}], "+", 
             RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"Rs", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "fs"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"n", "+", 
             RowBox[{"bt", " ", "Is", " ", "Rs"}]}], ")"}]}], "+", 
          RowBox[{"fn", " ", "Is", " ", 
           RowBox[{"(", 
            RowBox[{"n", "+", 
             RowBox[{"bt", " ", "Is", " ", "Rs"}], "+", 
             RowBox[{"bt", " ", "Vi"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], "+", 
             "Vi"}], ")"}]}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"bt", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"al", " ", "fs"}], "-", "Is"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"al", " ", "fn"}], "-", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], 
               "+", "Vi"}], ")"}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}]}], ")"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.600583013265625*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Yin", ":=", 
   RowBox[{"bt", "*", "Rs", "*", 
    RowBox[{"Is", "/", 
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"al", "*", "fn"}]}], ")"}]}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"bt", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rs", "*", "Is"}], "+", "Vi"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"al", "*", "fn"}]}], ")"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.600660077546875*^9, 3.600660104671875*^9}}],

Cell[BoxData[
 RowBox[{"Zin", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductLog", "[", "Yin", "]"}], "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"al", "*", "fn"}]}], ")"}], "/", "bt"}], "/", "Rs"}]}], "+", 
   RowBox[{"Vi", "/", "Rsh"}], "-", "Is", "-", "Ii"}]}]], "Input",
 CellChangeTimes->{{3.600660118390625*^9, 3.600660137640625*^9}, {
  3.60066019*^9, 3.600660195078125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"Zin", ",", "al"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60066015503125*^9, 3.600660156328125*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"fn", " ", 
    RowBox[{"ProductLog", "[", 
     FractionBox[
      RowBox[{"bt", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"bt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", "Is", " ", 
       "Rs"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"bt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"al", " ", "fn"}], "-", "n"}], ")"}], " ", 
       RowBox[{"ProductLog", "[", 
        FractionBox[
         RowBox[{"bt", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"bt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", "Is", " ", 
          "Rs"}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}]}]}], ")"}]}], 
   RowBox[{"bt", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"al", " ", "fn"}], "-", "n"}], ")"}], " ", "Rs", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]]], " ", "Is", " ", 
         "Rs"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "al"}], " ", "fn"}], "+", "n"}]], "]"}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.600660159015625*^9, 3.6006601659375*^9}, 
   3.60066019815625*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"YiIs", ":=", 
   RowBox[{"bt", "*", "Rs", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Is", "-", 
       RowBox[{"al", "*", "fs"}]}], ")"}], "/", "n"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"bt", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rs", "*", 
           RowBox[{"(", 
            RowBox[{"Is", "-", 
             RowBox[{"al", "*", "fs"}]}], ")"}]}], "+", "Vi"}], ")"}], "/", 
        "n"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6006697609375*^9, 3.600669787765625*^9}}],

Cell[BoxData[
 RowBox[{"ZiIs", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductLog", "[", "YiIs", "]"}], "*", 
    RowBox[{
     RowBox[{"n", "/", "bt"}], "/", "Rs"}]}], "+", 
   RowBox[{"Vi", "/", "Rsh"}], "-", 
   RowBox[{"(", 
    RowBox[{"Is", "-", 
     RowBox[{"al", "*", "fs"}]}], ")"}], "-", "Ii"}]}]], "Input",
 CellChangeTimes->{{3.60066980003125*^9, 3.60066982325*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ZiIs", ",", "al"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60066983609375*^9, 3.60066983721875*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"fs", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"al", " ", "fs"}], "-", "Is"}], ")"}], " ", "Rs"}], "+", 
     RowBox[{"n", " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "al"}], " ", "fs", " ", "Rs"}], "+", 
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", "Rs"}],
         "n"], "]"}]}]}], ")"}]}], 
  RowBox[{"bt", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"al", " ", "fs"}], "-", "Is"}], ")"}], " ", "Rs", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "al"}], " ", "fs", " ", "Rs"}], "+", 
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fs"}], "+", "Is"}], ")"}], " ", "Rs"}], 
       "n"], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.60066984490625*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"YiR", ":=", 
   RowBox[{"bt", "*", 
    RowBox[{"(", 
     RowBox[{"Rs", "-", 
      RowBox[{"al", "*", "fr"}]}], ")"}], "*", 
    RowBox[{"Is", "/", "n"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"bt", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rs", "-", 
             RowBox[{"al", "*", "fr"}]}], ")"}], "*", "Is"}], "+", "Vi"}], 
         ")"}], "/", "n"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.600677277125*^9, 3.600677301015625*^9}}],

Cell[BoxData[
 RowBox[{"ZiR", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductLog", "[", "YiR", "]"}], "*", 
    RowBox[{
     RowBox[{"n", "/", "bt"}], "/", 
     RowBox[{"(", 
      RowBox[{"Rs", "-", 
       RowBox[{"al", "*", "fr"}]}], ")"}]}]}], "+", 
   RowBox[{"Vi", "/", "Rsh"}], "-", "Is", "-", "Ii"}]}]], "Input",
 CellChangeTimes->{{3.600677314328125*^9, 3.600677335921875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ZiR", ",", "al"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6006773449375*^9, 3.600677345953125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"fr", " ", 
   RowBox[{"ProductLog", "[", 
    FractionBox[
     RowBox[{"bt", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"bt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "al"}], " ", "fr", " ", "Is"}], "+", 
           RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", "Is", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], "n"], "]"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bt", " ", "Is", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"al", " ", "fr"}], "-", "Rs"}], ")"}]}], "+", 
     RowBox[{"n", " ", 
      RowBox[{"ProductLog", "[", 
       FractionBox[
        RowBox[{"bt", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"bt", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "al"}], " ", "fr", " ", "Is"}], "+", 
              RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
         "Is", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], "n"], 
       "]"}]}]}], ")"}]}], 
  RowBox[{"bt", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"ProductLog", "[", 
      FractionBox[
       RowBox[{"bt", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"bt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "al"}], " ", "fr", " ", "Is"}], "+", 
             RowBox[{"Is", " ", "Rs"}], "+", "Vi"}], ")"}]}], "n"]], " ", 
        "Is", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "al"}], " ", "fr"}], "+", "Rs"}], ")"}]}], "n"], 
      "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.60067735415625*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"YiRh", ":=", 
   RowBox[{"bt", "*", "Rs", "*", 
    RowBox[{"Is", "/", "n"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"bt", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rs", "*", "Is"}], "+", "Vi"}], ")"}], "/", "n"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6006774825625*^9, 3.60067751021875*^9}}],

Cell[BoxData[
 RowBox[{"ZiRh", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductLog", "[", "YiRh", "]"}], "*", 
    RowBox[{
     RowBox[{"n", "/", "bt"}], "/", "Rs"}]}], "+", 
   RowBox[{"Vi", "/", 
    RowBox[{"(", 
     RowBox[{"Rsh", "-", 
      RowBox[{"al", "*", "fh"}]}], ")"}]}], "-", "Is", "-", "Ii"}]}]], "Input",
 CellChangeTimes->{{3.600677525796875*^9, 3.60067754578125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"ZiRh", ",", "al"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.60067755546875*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"fh", " ", "Vi"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "al"}], " ", "fh"}], "+", "Rsh"}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.600677564296875*^9}]
}, Open  ]]
},
WindowSize->{1016, 651},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 3053, 53, 92, "Input"],
Cell[3623, 77, 1926, 61, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5586, 143, 2653, 79, 220, "Input"],
Cell[8242, 224, 1949, 62, 110, "Output"],
Cell[10194, 288, 1364, 42, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11595, 335, 237, 5, 52, "Input"],
Cell[11835, 342, 1399, 44, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13271, 391, 235, 5, 52, "Input"],
Cell[13509, 398, 941, 29, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14487, 432, 238, 5, 52, "Input"],
Cell[14728, 439, 136, 4, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14901, 448, 313, 7, 72, "Input"],
Cell[15217, 457, 3903, 114, 246, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19157, 576, 715, 19, 72, "Input"],
Cell[19875, 597, 1009, 32, 100, "Output"],
Cell[20887, 631, 1006, 32, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21930, 668, 307, 7, 52, "Input"],
Cell[22240, 677, 1833, 57, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24110, 739, 181, 4, 31, "Input"],
Cell[24294, 745, 2437, 74, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26768, 824, 178, 4, 31, "Input"],
Cell[26949, 830, 1744, 52, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28730, 887, 176, 4, 31, "Input"],
Cell[28909, 893, 70, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29016, 899, 178, 4, 31, "Input"],
Cell[29197, 905, 1064, 34, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30298, 944, 113, 3, 31, "Input"],
Cell[30414, 949, 1063, 34, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31514, 988, 178, 4, 31, "Input"],
Cell[31695, 994, 950, 29, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32682, 1028, 180, 4, 31, "Input"],
Cell[32865, 1034, 926, 29, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33828, 1068, 180, 4, 31, "Input"],
Cell[34011, 1074, 70, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34118, 1080, 423, 14, 52, "Input"],
Cell[34544, 1096, 1009, 32, 100, "Output"]
}, Open  ]],
Cell[35568, 1131, 423, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[36016, 1147, 94, 1, 31, "Input"],
Cell[36113, 1150, 978, 30, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37128, 1185, 179, 4, 31, "Input"],
Cell[37310, 1191, 2338, 70, 196, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39685, 1266, 174, 4, 31, "Input"],
Cell[39862, 1272, 2348, 70, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42247, 1347, 180, 4, 31, "Input"],
Cell[42430, 1353, 1631, 49, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44098, 1407, 177, 4, 31, "Input"],
Cell[44278, 1413, 69, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44384, 1419, 181, 4, 31, "Input"],
Cell[44568, 1425, 2348, 70, 196, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46953, 1500, 218, 6, 52, "Input"],
Cell[47174, 1508, 1992, 60, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49203, 1573, 182, 4, 31, "Input"],
Cell[49388, 1579, 1993, 60, 113, "Output"]
}, Open  ]],
Cell[51396, 1642, 378, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[51799, 1657, 94, 1, 31, "Input"],
Cell[51896, 1660, 941, 29, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52874, 1694, 176, 4, 31, "Input"],
Cell[53053, 1700, 2348, 70, 196, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55438, 1775, 178, 4, 31, "Input"],
Cell[55619, 1781, 1993, 60, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57649, 1846, 178, 4, 31, "Input"],
Cell[57830, 1852, 2037, 61, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59904, 1918, 182, 4, 31, "Input"],
Cell[60089, 1924, 117, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60243, 1931, 182, 4, 31, "Input"],
Cell[60428, 1937, 140, 4, 47, "Output"]
}, Open  ]],
Cell[60583, 1944, 1013, 32, 52, "Input"],
Cell[61599, 1978, 632, 20, 31, "Input"],
Cell[CellGroupData[{
Cell[62256, 2002, 177, 4, 31, "Input"],
Cell[62436, 2008, 8284, 250, 354, "Output"]
}, Open  ]],
Cell[70735, 2261, 583, 18, 31, "Input"],
Cell[71321, 2281, 436, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[71782, 2297, 181, 4, 31, "Input"],
Cell[71966, 2303, 2214, 70, 114, "Output"]
}, Open  ]],
Cell[74195, 2376, 600, 19, 31, "Input"],
Cell[74798, 2397, 382, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[75205, 2412, 181, 4, 31, "Input"],
Cell[75389, 2418, 1573, 48, 110, "Output"]
}, Open  ]],
Cell[76977, 2469, 596, 19, 31, "Input"],
Cell[77576, 2490, 391, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[77992, 2505, 180, 4, 31, "Input"],
Cell[78175, 2511, 2149, 69, 110, "Output"]
}, Open  ]],
Cell[80339, 2583, 413, 13, 31, "Input"],
Cell[80755, 2598, 389, 11, 31, "Input"],
Cell[CellGroupData[{
Cell[81169, 2613, 158, 4, 31, "Input"],
Cell[81330, 2619, 240, 8, 49, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
